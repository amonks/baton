function Baton(){var a={},c=null,e=null;a.callback=null;var f=null,g=null;a.checkSupport=function(){var a=function(){try{return!!navigator.requestMIDIAccess}catch(a){return!1}}();return a},a.connect=function(a){e=a,navigator.requestMIDIAccess().then(j,k)},a.check=function(){return null===c?!1:!0},a.inputs=function(){return f},a.outputs=function(){return g},a.listen=function(b){a.check()===!0?(c.inputs()[b].onmidimessage=l,console.log("Hooked up input # "+b+": "+c.inputs()[b].name)):console.log("Not connected.")},a.send=function(b,d){if(a.check()===!0){var e=[];switch(d.type){case"control":e.push(175+d.channel);break;default:e.push(143+d.channel)}e.push(d.note),e.push(d.value),c.outputs()[b].send(e),console.log("sending to "+c.outputs()[b].name,e)}else console.log("Not connected.")};var h=function(){out=[];for(var a in c.inputs())out.push(c.inputs()[a].name);f=out},i=function(){out=[];for(var a in c.outputs())out.push(c.outputs()[a].name);g=out},j=function(a){console.log("connected!"),c=a,h(),i(),"function"==typeof e&&e()},k=function(a){alert("Failed to initialize MIDI - "+(1==a.code?"permission denied":"error code "+a.code))},l=function(b){var c={};if(3==b.data.length){var d=b.data[0];switch(console.log("firstBit",d),!0){case d>=128&&144>d:c.type="noteoff",c.channel=d-127;break;case d>=144&&160>d:c.type="note",c.channel=d-143;break;case d>=160&&176>d:c.type="polypress",c.channel=d-159;break;case d>=176&&192>d:c.type="control",c.channel=d-175;break;case d>=192&&208>d:c.type="program",c.channel=d-191;break;case d>=208&&224>d:c.type="aftertouch",c.channel=d-207;break;case d>=224:c.type="pitchbend",c.channel=d-223}c.note=parseInt(b.data[1].toString(10)),c.value=parseInt(b.data[2].toString(10)),"function"==typeof a.callback&&a.callback(c)}};return a.checkSupport()===!0?a:(console.log("Looks like your browser doesn't support WebMIDI."),console.log("If you're in OSX Chrome, enable the chrome://flags/#enable-web-midi flag and relaunch Chrome."),console.log("Otherwise try the Jazz-Soft Jazz plugin."),console.log("More info at http://baton.monks.co"),void 0)}

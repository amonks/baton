function Baton(){var a={},c=null,e=null;a.callback=null;var f=null;a.connect=function(a){e=a,navigator.requestMIDIAccess().then(h,i)},a.check=function(){return null===c?!1:!0},a.inputs=function(){return f},a.listen=function(b){a.check()===!0?(c.inputs()[b].onmidimessage=j,console.log("Hooked up input # "+b+": "+a.inputs[b])):console.log("Not connected.")};var g=function(){out=[];for(var a in c.inputs())out.push(c.inputs()[a].name);f=out,console.log(out)},h=function(a){c=a,g(),"function"==typeof e&&e()},i=function(a){alert("Failed to initialize MIDI - "+(1==a.code?"permission denied":"error code "+a.code))},j=function(b){var c={};3==b.data.length&&(parseInt(b.data[0].toString(10))>175?(c.type="control",c.channel=parseInt(b.data[0].toString(10))-175):(c.type="note",c.channel=parseInt(b.data[0].toString(10))-143),c.note=parseInt(b.data[1].toString(10)),c.value=parseInt(b.data[2].toString(10)),console.log(c),"function"==typeof a.callback&&a.callback(c))};return a}
